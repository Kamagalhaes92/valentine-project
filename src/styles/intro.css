/* =========================
   INTRO THEME VARIABLES
========================= */
:root {
  --rose: #e8b8c0; /* dusty rose */
  --rose-deep: #d78a98;
  --cream: #fff7f5;
  --ink: #3a2b2e;
}

/* =========================
   LAYOUT WRAPPERS
========================= */
.intro {
  height: calc(var(--vh, 1vh) * 100);
  width: 100vw;
  overflow: hidden;
}

.introTitle {
  margin: 0;
  text-align: center;
  font-family: "Ms Madi", cursive;
  font-size: clamp(28px, 5vw, 56px);
  color: rgba(58, 43, 46, 0.9);
  text-shadow:
    0 1px 0 rgba(255, 255, 255, 0.6),
    0 10px 30px rgba(0, 0, 0, 0.12);
  pointer-events: none;
}
/* =========================
   3D GLASS TITLE
========================= */

.titleWrap {
  position: absolute;
  top: clamp(72px, 10vh, 120px);
  left: 50%;
  transform: translateX(-50%);
  z-index: 12;

  width: fit-content;
  max-width: min(92vw, 760px);
  padding: 12px 18px;

  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;

  border-radius: 999px;
  background: linear-gradient(
    to bottom,
    rgba(255, 255, 255, 0.62),
    rgba(255, 255, 255, 0.22)
  );
  border: 1px solid rgba(255, 255, 255, 0.45);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);

  box-shadow:
    0 18px 40px rgba(0, 0, 0, 0.1),
    inset 0 1px 0 rgba(255, 255, 255, 0.7),
    inset 0 -10px 18px rgba(255, 170, 210, 0.18);
}
/* glow aura behind the title */
.titleWrap::before {
  content: "";
  position: absolute;
  inset: -18px;
  border-radius: 999px;
  background: radial-gradient(
    circle at 50% 40%,
    rgba(255, 220, 240, 0.85),
    transparent 70%
  );
  filter: blur(18px);
  opacity: 0.65;
  z-index: -1;
}

/* shiny highlight band */
.titleWrap::after {
  content: "";
  position: absolute;
  left: 8%;
  right: 8%;
  top: 10px;
  height: 14px;
  border-radius: 999px;
  background: linear-gradient(
    to right,
    transparent,
    rgba(255, 255, 255, 0.65),
    transparent
  );
  opacity: 0.55;
}

/* tiny bounce on the emoji */
.titleEmoji {
  display: inline-block;
  transform: translateY(4px);
  animation: emojiFloat 2.8s ease-in-out infinite;
}

@keyframes emojiFloat {
  0%,
  100% {
    transform: translateY(4px);
  }
  50% {
    transform: translateY(-2px);
  }
}

.bubble--glass {
  background: rgba(255, 255, 255, 0.35);
  border: 1px solid rgba(255, 255, 255, 0.55);
  backdrop-filter: blur(10px);
  color: rgba(58, 43, 46, 0.9);
  font-family: "Cormorant Garamond", serif;
}

.caret {
  display: inline-block;
  width: 10px;
  height: 18px;
  margin-left: 6px;
  border-right: 2px solid rgba(58, 43, 46, 0.55);
  animation: blink 0.9s steps(1) infinite;
  transform: translateY(2px);
}

@keyframes blink {
  50% {
    opacity: 0;
  }
}

.scene {
  position: relative;
  width: 100vw;
  height: 100svh; /* iOS safe viewport */
  height: 100dvh; /* dynamic viewport */
  height: 100vh; /* fallback */
  height: 100dvh;
  overflow: hidden;

  background-color: #fff; /* prevents black flash if image fails */
  background-image: url("/background.png");
  background-position: center;
  background-size: cover;
  background-repeat: no-repeat;
}

/* blur overlay that fades out after load */
.scene::before {
  content: "";
  position: absolute;
  inset: 0;
  background: inherit;
  filter: blur(6px) saturate(1.05);
  transform: scale(1.04);
  opacity: 1;
  transition:
    filter 1.6s ease,
    opacity 1.6s ease;
  z-index: 0;
}

.scene.isLoaded::before {
  filter: blur(0px) saturate(1);
  opacity: 0;
}

/* subtle grain */
.scene::after {
  content: "";
  position: absolute;
  inset: -20%;
  pointer-events: none;
  background-image: url("/grain.png");
  background-size: 420px 420px;
  opacity: 0.12;
  mix-blend-mode: overlay;
  animation: grainMove 6s steps(6) infinite;
  z-index: 6;
}

@keyframes grainMove {
  0% {
    transform: translate(0, 0);
  }
  20% {
    transform: translate(-2%, 1%);
  }
  40% {
    transform: translate(1%, -2%);
  }
  60% {
    transform: translate(-1%, -1%);
  }
  80% {
    transform: translate(2%, 1%);
  }
  100% {
    transform: translate(0, 0);
  }
}

/* vignette for depth */
.vignette {
  position: absolute;
  inset: 0;
  pointer-events: none;
  background: radial-gradient(
    ellipse at center,
    rgba(0, 0, 0, 0) 55%,
    rgba(40, 18, 24, 0.22) 100%
  );
  z-index: 5;
}

/* =========================
   TOP UI
========================= */
.musicToggle {
  position: absolute;
  top: 16px;
  right: 16px;
  border: none;
  background: rgba(255, 255, 255, 0.82);
  border-radius: 14px;
  padding: 10px 12px;
  cursor: pointer;
  z-index: 20;
  box-shadow: 0 8px 22px rgba(0, 0, 0, 0.08);
}

.musicToggle:active {
  transform: scale(0.98);
}

.decorTop {
  position: absolute;
  top: -10rem;
  left: 50%;
  transform: translateX(-50%);
  width: min(520px, 85vw);
  height: auto;
  pointer-events: none;
  z-index: 2;
}

/* =========================
   HEART TRAIL
========================= */
.heart {
  position: absolute;
  width: 65px;
  height: 65px;
  background: url("/heart.png") center / contain no-repeat;
  opacity: 0.95;
  z-index: 2;
}

/* =========================
   DUCK + BUBBLE
========================= */
.duck {
  position: absolute;
  width: 20rem;
  height: 20rem;
  background: url("/duck.png") center / contain no-repeat;

  /* ✅ you said you switched to this */
  transform: translate(-50%, -50%);
  transition: left 140ms linear;
  z-index: 3;
}

/* flip duck */
.duck--left {
  transform: translate(-50%, -50%) scaleX(-1);
}

/* hop animation */
.duck--jump {
  animation: hop 220ms ease-out;
}

/* hop for normal facing */
@keyframes hop {
  0% {
    transform: translate(-50%, -50%);
  }
  50% {
    transform: translate(-50%, -62%);
  }
  100% {
    transform: translate(-50%, -50%);
  }
}

/* hop for flipped duck */
.duck.duck--left.duck--jump {
  animation: hopLeft 220ms ease-out;
}

@keyframes hopLeft {
  0% {
    transform: translate(-50%, -50%) scaleX(-1);
  }
  50% {
    transform: translate(-50%, -62%) scaleX(-1);
  }
  100% {
    transform: translate(-50%, -50%) scaleX(-1);
  }
}

/* bubble */
.bubble {
  position: absolute;
  transform: translate(-50%, -50%);
  z-index: 8;

  max-width: min(560px, 88vw);
  padding: 14px 16px;
  border-radius: 18px;

  /* modern glass */
  background: linear-gradient(
    to bottom,
    rgba(255, 255, 255, 0.58),
    rgba(255, 255, 255, 0.28)
  );
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);

  border: 1px solid rgba(255, 255, 255, 0.55);
  box-shadow:
    0 18px 50px rgba(0, 0, 0, 0.14),
    inset 0 1px 0 rgba(255, 255, 255, 0.75);

  color: rgba(58, 43, 46, 0.92);
  font-family: "Cormorant Garamond", serif;
  font-size: 18px;
  line-height: 1.2;
}

/* cute shine */
.bubble::before {
  content: "";
  position: absolute;
  left: 10%;
  right: 10%;
  top: 8px;
  height: 12px;
  border-radius: 999px;
  background: linear-gradient(
    to right,
    transparent,
    rgba(255, 255, 255, 0.65),
    transparent
  );
  opacity: 0.55;
}

/* tail */
.bubble::after {
  content: "";
  position: absolute;
  left: 22%;
  bottom: -8px;
  width: 14px;
  height: 14px;
  background: rgba(255, 255, 255, 0.42);
  border-right: 1px solid rgba(255, 255, 255, 0.45);
  border-bottom: 1px solid rgba(255, 255, 255, 0.45);
  transform: rotate(45deg);
  backdrop-filter: blur(10px);
}

/* =========================
   DOOR
========================= */
.door {
  position: absolute;
  right: 2%;
  bottom: 18%; /* ✅ adjust this to match floor line */
  width: min(40vw, 520px);
  height: min(52vh, 520px);
  background: url("/door.png") center / contain no-repeat;
  border: none;
  cursor: pointer;
  z-index: 2;
}

.door:disabled {
  opacity: 0.7;
  cursor: not-allowed;
  filter: grayscale(0.4);
}

.door--glow {
  transform: scale(1.2);
  transition: transform 0.3s ease-in-out;
}

.enterBtn {
  position: absolute;
  left: 78%;
  top: 72%; /* tweak to sit under the door */
  transform: translate(-50%, -50%);
  z-index: 30;

  padding: 12px 16px;
  border-radius: 999px;
  border: 1px solid rgba(255, 255, 255, 0.6);

  background: linear-gradient(
    to bottom,
    rgba(255, 255, 255, 0.62),
    rgba(255, 255, 255, 0.25)
  );
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);

  box-shadow:
    0 16px 45px rgba(0, 0, 0, 0.14),
    0 0 0 4px rgba(255, 212, 234, 0.18);

  color: rgba(58, 43, 46, 0.92);
  font-weight: 700;
  cursor: pointer;

  animation: enterPulse 1.9s ease-in-out infinite;
}

@keyframes enterPulse {
  0%,
  100% {
    transform: translate(-50%, -50%) scale(1);
  }
  50% {
    transform: translate(-50%, -50%) scale(1.06);
  }
}

.enterBtn:active {
  transform: translate(-50%, -50%) scale(0.98);
}

@media (max-width: 420px) {
  .enterBtn {
    top: 74%;
    left: 80%;
    padding: 10px 14px;
    font-size: 14px;
  }
}

/* =========================
   DOOR TRANSITION OVERLAY
========================= */
.doorTransition {
  position: absolute;
  inset: 0;
  z-index: 999;
  overflow: hidden;

  background: radial-gradient(
    circle at 50% 40%,
    #b9f3fb 0%,
    #77d1e0 48%,
    #2aa8c2 82%,
    #0b4f6a 100%
  );

  animation: transIn 320ms ease-out forwards;
}

@keyframes transIn {
  from {
    opacity: 0;
    transform: scale(1.02);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

/* stars */
.doorStars {
  position: absolute;
  inset: -20%;
  background-image:
    radial-gradient(rgba(255, 255, 255, 0.95) 1px, transparent 1.6px),
    radial-gradient(rgba(255, 255, 255, 0.7) 1px, transparent 1.6px),
    radial-gradient(rgba(255, 255, 255, 0.45) 1px, transparent 1.6px);
  background-size:
    60px 60px,
    110px 110px,
    160px 160px;
  background-position:
    0 0,
    25px 40px,
    60px 10px;
  opacity: 0.65;
  animation: starDrift 2.8s linear infinite;
}

@keyframes starDrift {
  to {
    transform: translateY(60px);
  }
}

/* =========================
   CSS-ONLY FLOATING HEARTS
========================= */
/* this element spawns many hearts via box-shadow */
/* Floating heart PNG layer */
.doorHearts {
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 2;
}

/* we create multiple hearts using pseudo elements + box-shadow */
.doorHearts::before,
.doorHearts::after {
  content: "";
  position: absolute;
  left: 0;
  top: 110%;
  width: 46px;
  height: 46px;
  background: url("/heartasset.png") center / contain no-repeat;
  opacity: 0.35;
  filter: blur(0.2px);

  animation: heartsUp 2.8s linear infinite;
}

/* smaller faster layer */
.doorHearts::after {
  width: 26px;
  height: 26px;
  opacity: 0.25;
  animation-duration: 2.2s;
  animation-delay: -1.1s;
}

/* MANY copies across the screen */
.doorHearts::before {
  box-shadow:
    4vw 0vh rgba(0, 0, 0, 0),
    10vw 18vh rgba(0, 0, 0, 0),
    16vw 8vh rgba(0, 0, 0, 0),
    22vw 28vh rgba(0, 0, 0, 0),
    28vw 14vh rgba(0, 0, 0, 0),
    34vw 34vh rgba(0, 0, 0, 0),
    40vw 6vh rgba(0, 0, 0, 0),
    46vw 26vh rgba(0, 0, 0, 0),
    52vw 12vh rgba(0, 0, 0, 0),
    58vw 32vh rgba(0, 0, 0, 0),
    64vw 18vh rgba(0, 0, 0, 0),
    70vw 38vh rgba(0, 0, 0, 0),
    76vw 10vh rgba(0, 0, 0, 0),
    82vw 28vh rgba(0, 0, 0, 0),
    88vw 16vh rgba(0, 0, 0, 0),
    94vw 36vh rgba(0, 0, 0, 0);
}

/* smaller layer positions */
.doorHearts::after {
  box-shadow:
    6vw 10vh rgba(0, 0, 0, 0),
    12vw 30vh rgba(0, 0, 0, 0),
    18vw 20vh rgba(0, 0, 0, 0),
    26vw 40vh rgba(0, 0, 0, 0),
    32vw 12vh rgba(0, 0, 0, 0),
    40vw 34vh rgba(0, 0, 0, 0),
    48vw 18vh rgba(0, 0, 0, 0),
    56vw 44vh rgba(0, 0, 0, 0),
    62vw 26vh rgba(0, 0, 0, 0),
    70vw 46vh rgba(0, 0, 0, 0),
    78vw 16vh rgba(0, 0, 0, 0),
    86vw 38vh rgba(0, 0, 0, 0),
    92vw 24vh rgba(0, 0, 0, 0);
}

/* floating animation with sway */
@keyframes heartsUp {
  0% {
    transform: translateY(0) translateX(0) rotate(0deg);
    opacity: 0;
  }
  10% {
    opacity: 0.9;
  }
  50% {
    transform: translateY(-85vh) translateX(-18px) rotate(-10deg);
  }
  100% {
    transform: translateY(-170vh) translateX(28px) rotate(18deg);
    opacity: 0;
  }
}
/* =========================
   BALLOONS
========================= */
.balloon {
  position: absolute;
  bottom: 20px;
  width: min(280px, 35vw);
  height: auto;
  pointer-events: none;
  z-index: 2;
  animation: floatSway 6s ease-in-out infinite;
}

.balloon--left {
  left: 12%;
}

.balloon--right {
  right: 12%;
  animation-delay: 0.8s;
}

@keyframes floatSway {
  0% {
    transform: translate(0px, 0px) rotate(0deg);
  }
  25% {
    transform: translate(6px, -6px) rotate(1deg);
  }
  50% {
    transform: translate(0px, -10px) rotate(0deg);
  }
  75% {
    transform: translate(-6px, -6px) rotate(-1deg);
  }
  100% {
    transform: translate(0px, 0px) rotate(0deg);
  }
}

/* =========================
   MOBILE CONTROLS
========================= */
.controls {
  position: absolute;
  left: 50%;
  bottom: 18px;
  transform: translateX(-50%);
  display: flex;
  gap: 12px;
  z-index: 20;
}

.ctrl {
  color: rgb(38, 46, 74);
  width: 70px;
  height: 60px;
  border-radius: 25%;
  border: 3px solid rgb(119, 150, 195);
  background: #ebd29c;
  font-size: 20px;
  cursor: pointer;
}

.ctrl:active {
  transform: scale(0.98);
}

button,
.door {
  cursor: url("/heartasset.png"), pointer;
}

.musicToggle--fancy {
  width: 52px;
  height: 52px;
  border-radius: 999px;
  display: grid;
  place-items: center;
  background: rgba(255, 255, 255, 0.25);
  border: 1px solid rgba(255, 255, 255, 0.5);
  backdrop-filter: blur(10px);
  box-shadow: 0 12px 40px rgba(0, 0, 0, 0.12);
}

.musicToggle--fancy::after {
  content: "";
  position: absolute;
  inset: -6px;
  border-radius: inherit;
  background: radial-gradient(
    circle,
    rgba(255, 212, 234, 0.75),
    transparent 70%
  );
  opacity: 0.55;
  filter: blur(8px);
  z-index: -1;
  animation: pulse 2.6s ease-in-out infinite;
}

.musicIcon {
  font-size: 20px;
}

@keyframes pulse {
  0%,
  100% {
    transform: scale(0.98);
    opacity: 0.5;
  }
  50% {
    transform: scale(1.08);
    opacity: 0.85;
  }
}

.door--magic {
  position: absolute;
  border: none;
  background: url("/door.png") center / contain no-repeat;
  isolation: isolate; /* keeps glow layers neat */
}

/* soft pulsing glow when duck is close */
.door--magic.door--active {
  animation: doorPulse 2.2s ease-in-out infinite;
  filter: drop-shadow(0 0 18px rgba(255, 212, 234, 0.9));
}

@keyframes doorPulse {
  0%,
  100% {
    transform: scale(1.02);
  }
  50% {
    transform: scale(1.07);
  }
}

/* light rays */
.doorRays {
  position: absolute;
  inset: -40%;
  z-index: -1;
  background: conic-gradient(
    from 0deg,
    transparent,
    rgba(255, 220, 240, 0.65),
    transparent,
    rgba(255, 220, 240, 0.45),
    transparent
  );
  filter: blur(10px);
  opacity: 0;
  transition: opacity 280ms ease;
  animation: raysSpin 3.8s linear infinite;
}

.door--magic.door--active .doorRays {
  opacity: 0.9;
}

@keyframes raysSpin {
  to {
    transform: rotate(360deg);
  }
}

/* sparkle particles */
.sparkle {
  position: absolute;
  width: 10px;
  height: 10px;
  border-radius: 999px;
  background: radial-gradient(
    circle,
    rgba(255, 255, 255, 1),
    rgba(255, 255, 255, 0)
  );
  box-shadow: 0 0 18px rgba(255, 212, 234, 1);
  z-index: 4;
  animation: sparklePop ease-out forwards;
}

@keyframes sparklePop {
  0% {
    opacity: 0;
    transform: translate(-50%, -50%) scale(0.2);
  }
  30% {
    opacity: 1;
    transform: translate(-50%, -50%) scale(1);
  }
  100% {
    opacity: 0;
    transform: translate(-50%, -80%) scale(0.2);
  }
}

/* =========================
   RESPONSIVE
========================= */
@media (max-width: 768px) {
  .introTitle {
    top: 68px;
  }
  .duck {
    width: 10rem;
    height: 10rem;
  }

  .door {
    right: 5%;
    bottom: 14%; /* slightly higher because floor takes more space */
    width: 38vw;
    height: 44vh;
  }

  .bubble {
    font-size: 15px;
    padding: 10px 12px;
    margin-left: 2rem;
  }

  .balloon {
    width: 28vw;
    bottom: 10px;
  }

  .decorTop {
    width: 70vw;
    top: -7rem;
  }

  .heart {
    width: 25px;
    height: 25px;
  }

  .titleWrap {
    top: 88px;
    padding: 10px 12px;
  }

  .controls {
    bottom: 14px;
  }

  .ctrl {
    width: 64px;
    height: 56px;
  }
}

@media (max-width: 980px) and (orientation: landscape) {
  .titleWrap {
    top: 10px;
    padding: 8px 12px;
  }

  .introTitle {
    font-size: clamp(22px, 4vw, 36px);
  }

  .decorTop {
    top: -9rem;
    width: min(420px, 70vw);
    opacity: 0.85;
  }

  .duck {
    width: 8rem;
    height: 8rem;
  }

  .bubble {
    font-size: 14px;
    max-width: min(520px, 78vw);
    padding: 10px 12px;
  }

  .door {
    width: min(32vw, 420px);
    height: min(56vh, 420px);
    bottom: 10%;
  }

  .balloon {
    width: 22vw;
    bottom: 4px;
    opacity: 0.9;
  }

  .controls {
    bottom: calc(env(safe-area-inset-bottom) + 8px);
  }

  .ctrl {
    width: 56px;
    height: 48px;
  }
}
